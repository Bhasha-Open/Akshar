<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>akshar.cli - Akshar documentation</title><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=e1a1ceaf" />
    <link rel="stylesheet" type="text/css" href="../../_static/shibuya.css?v=14737038" />
    <link media="print" rel="stylesheet" type="text/css" href="../../_static/print.css?v=20ff2c19" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/><meta property="og:title" content="akshar.cli"/>
    <meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../../index.html">
      
      
      <strong>Akshar</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials"></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2"></span>
          <span class="hamburger_3"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><p class="caption" role="heading" aria-level="3"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/overview.html">Features Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/graphemes.html">Graphemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/basic.html">Basic Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/tokenizer.html">Tokenizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/normalize.html">Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/segment.html">Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/morph.html">Morphology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/phonetic.html">Phonetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/script_utils.html">Script Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/sandhi.html">Sandhi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/schwa.html">Schwa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/anusvara.html">Anusvara</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/vedic.html">Vedic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/visarga.html">Visarga</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/transliteration.html">Transliteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/features.html">Features (Module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/viz.html">Visualizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/app.html">App</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/cli_api.html">CLI (API)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../../index.html"><span itemprop="name">Akshar</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">Module code</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">akshar.cli</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
        <article class="yue" role="main">
          <h1>Source code for akshar.cli</h1><div class="highlight"><pre>
<span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Command-line interface for Akshar.</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">Commands</span>
</span><span data-line="5"><span class="sd">--------</span>
</span><span data-line="6"><span class="sd">tokenize:</span>
</span><span data-line="7"><span class="sd">    Tokenize text from an argument or file, with optional model and formats.</span>
</span><span data-line="8"><span class="sd">detokenize:</span>
</span><span data-line="9"><span class="sd">    Convert tokens back to text (best-effort heuristics per model type).</span>
</span><span data-line="10"><span class="sd">explain:</span>
</span><span data-line="11"><span class="sd">    Print a human-readable breakdown of the processing pipeline.</span>
</span><span data-line="12"><span class="sd">train:</span>
</span><span data-line="13"><span class="sd">    Train a SentencePiece or BPE tokenizer from a corpus.</span>
</span><span data-line="14"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="15">
</span><span data-line="16"><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
</span><span data-line="17"><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span data-line="18"><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span data-line="19"><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span data-line="20">
</span><span data-line="21"><span class="kn">from</span><span class="w"> </span><span class="nn">.tokenizer</span><span class="w"> </span><span class="kn">import</span> <span class="n">aksharTokenizer</span>
</span><span data-line="22"><span class="kn">from</span><span class="w"> </span><span class="nn">.normalize</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalize_text</span>
</span><span data-line="23">
</span><span data-line="24">
<div class="viewcode-block" id="tokenize_command">
<a class="viewcode-back" href="../../cli.html#akshar.cli.tokenize_command">[docs]</a>
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">tokenize_command</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span data-line="26"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle the &#39;tokenize&#39; subcommand.</span>
</span><span data-line="27"><span class="sd">    </span>
</span><span data-line="28"><span class="sd">    Parameters</span>
</span><span data-line="29"><span class="sd">    ----------</span>
</span><span data-line="30"><span class="sd">    args:</span>
</span><span data-line="31"><span class="sd">        argparse.Namespace with fields:</span>
</span><span data-line="32"><span class="sd">        - text (str | None)</span>
</span><span data-line="33"><span class="sd">        - input (str | None) path to a text file</span>
</span><span data-line="34"><span class="sd">        - model (str | None) model path if using SP/BPE</span>
</span><span data-line="35"><span class="sd">        - model_type (str) &#39;sentencepiece&#39; or &#39;bpe&#39;</span>
</span><span data-line="36"><span class="sd">        - format (str) &#39;text&#39; | &#39;json&#39; | &#39;id&#39;</span>
</span><span data-line="37"><span class="sd">        - output (str | None) file to write output</span>
</span><span data-line="38"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="39">    <span class="c1"># check if model file exists when provided</span>
</span><span data-line="40">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">model</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span data-line="41">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Model file not found: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="42">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current directory: </span><span class="si">{</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="43">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  To train a model: akshar train &lt;corpus.txt&gt; --output models/akshar --vocab-size 24000&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="44">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="45">    
</span><span data-line="46">    <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">aksharTokenizer</span><span class="p">(</span>
</span><span data-line="47">        <span class="n">model_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
</span><span data-line="48">        <span class="n">model_type</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">model_type</span>
</span><span data-line="49">    <span class="p">)</span>
</span><span data-line="50">    
</span><span data-line="51">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
</span><span data-line="52">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="53">            <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span data-line="54">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="55">        <span class="n">text</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">text</span>
</span><span data-line="56">    
</span><span data-line="57">    <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span><span class="p">:</span>
</span><span data-line="58">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: No text provided. Use --input or provide text as argument.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="59">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="60">    
</span><span data-line="61">    <span class="c1"># determine output format</span>
</span><span data-line="62">    <span class="n">output_format</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span>
</span><span data-line="63">    
</span><span data-line="64">    <span class="c1"># handle output</span>
</span><span data-line="65">    <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span>
</span><span data-line="66">        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>
</span><span data-line="67">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: --model required for ID output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="68">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="69">        <span class="k">if</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="70">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Failed to load model from </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="71">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Make sure the model file exists and is valid.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="72">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="73">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="74">            <span class="n">ids</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span data-line="75">            <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">ids</span><span class="p">))</span>
</span><span data-line="76">        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="77">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="78">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="79">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="80">        <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span data-line="81">        <span class="k">if</span> <span class="n">output_format</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
</span><span data-line="82">            <span class="n">output</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span data-line="83">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="84">            <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span data-line="85">    
</span><span data-line="86">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
</span><span data-line="87">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="88">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span data-line="89">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="90">        <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span></div>

</span><span data-line="91">
</span><span data-line="92">
<div class="viewcode-block" id="detokenize_command">
<a class="viewcode-back" href="../../cli.html#akshar.cli.detokenize_command">[docs]</a>
</span><span data-line="93"><span class="k">def</span><span class="w"> </span><span class="nf">detokenize_command</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span data-line="94"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle the &#39;detokenize&#39; subcommand.</span>
</span><span data-line="95"><span class="sd">    </span>
</span><span data-line="96"><span class="sd">    Parameters</span>
</span><span data-line="97"><span class="sd">    ----------</span>
</span><span data-line="98"><span class="sd">    args:</span>
</span><span data-line="99"><span class="sd">        argparse.Namespace with fields:</span>
</span><span data-line="100"><span class="sd">        - tokens (str | None) space-separated tokens if not using --input</span>
</span><span data-line="101"><span class="sd">        - input (str | None) file path containing tokens or JSON list</span>
</span><span data-line="102"><span class="sd">        - output (str | None) destination path</span>
</span><span data-line="103"><span class="sd">        - model (str | None), model_type (str) for model-aware heuristics</span>
</span><span data-line="104"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="105">    <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">aksharTokenizer</span><span class="p">(</span>
</span><span data-line="106">        <span class="n">model_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
</span><span data-line="107">        <span class="n">model_type</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">model_type</span>
</span><span data-line="108">    <span class="p">)</span>
</span><span data-line="109">    
</span><span data-line="110">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">:</span>
</span><span data-line="111">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="112">            <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span data-line="113">            <span class="c1"># try to parse as JSON first</span>
</span><span data-line="114">            <span class="k">try</span><span class="p">:</span>
</span><span data-line="115">                <span class="n">tokens</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span><span data-line="116">            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
</span><span data-line="117">                <span class="c1"># assume space-separated tokens</span>
</span><span data-line="118">                <span class="n">tokens</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span data-line="119">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="120">        <span class="n">tokens</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span data-line="121">    
</span><span data-line="122">    <span class="n">text</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">detokenize</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span data-line="123">    
</span><span data-line="124">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
</span><span data-line="125">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="126">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span data-line="127">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="128">        <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

</span><span data-line="129">
</span><span data-line="130">
<div class="viewcode-block" id="explain_command">
<a class="viewcode-back" href="../../cli.html#akshar.cli.explain_command">[docs]</a>
</span><span data-line="131"><span class="k">def</span><span class="w"> </span><span class="nf">explain_command</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span data-line="132"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle &#39;explain&#39; - print a detailed pipeline breakdown.</span>
</span><span data-line="133"><span class="sd">    </span>
</span><span data-line="134"><span class="sd">    Shows normalized text, akshars, script segments, tokens, and stats.</span>
</span><span data-line="135"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="136">    <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">aksharTokenizer</span><span class="p">(</span>
</span><span data-line="137">        <span class="n">model_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
</span><span data-line="138">        <span class="n">model_type</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">model_type</span>
</span><span data-line="139">    <span class="p">)</span>
</span><span data-line="140">    
</span><span data-line="141">    <span class="n">analysis</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span data-line="142">    
</span><span data-line="143">    <span class="c1"># pretty print the analysis</span>
</span><span data-line="144">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== akshar Analysis ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="145">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="146">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Normalized: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;normalized&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="147">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">akshars (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;akshars&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
</span><span data-line="148">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;akshars&#39;</span><span class="p">]))</span>
</span><span data-line="149">    
</span><span data-line="150">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Code Switches (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;code_switches&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
</span><span data-line="151">    <span class="k">for</span> <span class="n">segment</span><span class="p">,</span> <span class="n">script</span> <span class="ow">in</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;code_switches&#39;</span><span class="p">]:</span>
</span><span data-line="152">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [</span><span class="si">{</span><span class="n">script</span><span class="si">:</span><span class="s2">12</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">segment</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="153">    
</span><span data-line="154">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tokens (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;tokens&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
</span><span data-line="155">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;tokens&#39;</span><span class="p">]))</span>
</span><span data-line="156">    
</span><span data-line="157">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Statistics:&quot;</span><span class="p">)</span>
</span><span data-line="158">    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span data-line="159">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span data-line="160">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="s1">&#39;ratio&#39;</span> <span class="ow">in</span> <span class="n">key</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="161">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="162">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

</span><span data-line="163">
</span><span data-line="164">
<div class="viewcode-block" id="preprocess_corpus">
<a class="viewcode-back" href="../../cli.html#akshar.cli.preprocess_corpus">[docs]</a>
</span><span data-line="165"><span class="k">def</span><span class="w"> </span><span class="nf">preprocess_corpus</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
</span><span data-line="166"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Preprocess a corpus file with Akshar normalization.</span>
</span><span data-line="167"><span class="sd">    </span>
</span><span data-line="168"><span class="sd">    Returns</span>
</span><span data-line="169"><span class="sd">    -------</span>
</span><span data-line="170"><span class="sd">    str</span>
</span><span data-line="171"><span class="sd">        Path to the written output_file.</span>
</span><span data-line="172"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="173">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preprocessing </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span data-line="174">    
</span><span data-line="175">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="176">        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span data-line="177">    
</span><span data-line="178">    <span class="n">processed</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="179">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span data-line="180">        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span data-line="181">        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
</span><span data-line="182">            <span class="k">continue</span>
</span><span data-line="183">        <span class="n">processed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalize_text</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
</span><span data-line="184">    
</span><span data-line="185">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span data-line="186">        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">processed</span><span class="p">:</span>
</span><span data-line="187">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span data-line="188">    
</span><span data-line="189">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrote </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">processed</span><span class="p">)</span><span class="si">}</span><span class="s2"> lines to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="190">    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span></div>

</span><span data-line="191">
</span><span data-line="192">
<div class="viewcode-block" id="train_command">
<a class="viewcode-back" href="../../cli.html#akshar.cli.train_command">[docs]</a>
</span><span data-line="193"><span class="k">def</span><span class="w"> </span><span class="nf">train_command</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span data-line="194"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle &#39;train&#39; - train SentencePiece or BPE on a corpus.</span>
</span><span data-line="195"><span class="sd">    </span>
</span><span data-line="196"><span class="sd">    Parameters</span>
</span><span data-line="197"><span class="sd">    ----------</span>
</span><span data-line="198"><span class="sd">    args:</span>
</span><span data-line="199"><span class="sd">        argparse.Namespace containing corpus path, output prefix, and options.</span>
</span><span data-line="200"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="201">    <span class="n">input_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
</span><span data-line="202">    <span class="k">if</span> <span class="ow">not</span> <span class="n">input_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span data-line="203">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Input file not found: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="204">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="205">    
</span><span data-line="206">    <span class="n">output_prefix</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</span><span data-line="207">    <span class="n">output_prefix</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="208">    
</span><span data-line="209">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;sentencepiece&#39;</span><span class="p">:</span>
</span><span data-line="210">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="211">            <span class="kn">import</span><span class="w"> </span><span class="nn">sentencepiece</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">spm</span>
</span><span data-line="212">        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span data-line="213">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: SentencePiece not installed.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="214">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Install with: pip install sentencepiece&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="215">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="216">        
</span><span data-line="217">        <span class="c1"># preprocess if needed</span>
</span><span data-line="218">        <span class="n">train_file</span> <span class="o">=</span> <span class="n">input_file</span>
</span><span data-line="219">        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">no_preprocess</span><span class="p">:</span>
</span><span data-line="220">            <span class="n">preprocessed</span> <span class="o">=</span> <span class="n">output_prefix</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.preprocessed.txt&#39;</span><span class="p">)</span>
</span><span data-line="221">            <span class="n">preprocess_corpus</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">preprocessed</span><span class="p">)</span>
</span><span data-line="222">            <span class="n">train_file</span> <span class="o">=</span> <span class="n">preprocessed</span>
</span><span data-line="223">        
</span><span data-line="224">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Training SentencePiece Model ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="225">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="n">train_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="226">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model prefix: </span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="227">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vocab size: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">vocab_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="228">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Character coverage: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">coverage</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="229">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model type: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">spm_model_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="230">        <span class="nb">print</span><span class="p">()</span>
</span><span data-line="231">        
</span><span data-line="232">        <span class="n">spm</span><span class="o">.</span><span class="n">SentencePieceTrainer</span><span class="o">.</span><span class="n">Train</span><span class="p">(</span>
</span><span data-line="233">            <span class="nb">input</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">train_file</span><span class="p">),</span>
</span><span data-line="234">            <span class="n">model_prefix</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_prefix</span><span class="p">),</span>
</span><span data-line="235">            <span class="n">vocab_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span>
</span><span data-line="236">            <span class="n">character_coverage</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">coverage</span><span class="p">,</span>
</span><span data-line="237">            <span class="n">model_type</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">spm_model_type</span><span class="p">,</span>
</span><span data-line="238">            <span class="n">split_by_unicode_script</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="239">            <span class="n">split_by_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="240">            <span class="n">normalization_rule_name</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">,</span>
</span><span data-line="241">            <span class="n">byte_fallback</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="242">            <span class="n">unk_piece</span><span class="o">=</span><span class="s1">&#39;&lt;unk&gt;&#39;</span><span class="p">,</span>
</span><span data-line="243">            <span class="n">bos_piece</span><span class="o">=</span><span class="s1">&#39;&lt;s&gt;&#39;</span><span class="p">,</span>
</span><span data-line="244">            <span class="n">eos_piece</span><span class="o">=</span><span class="s1">&#39;&lt;/s&gt;&#39;</span><span class="p">,</span>
</span><span data-line="245">            <span class="n">pad_piece</span><span class="o">=</span><span class="s1">&#39;&lt;pad&gt;&#39;</span><span class="p">,</span>
</span><span data-line="246">            <span class="n">control_symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&lt;mask&gt;&#39;</span><span class="p">],</span>
</span><span data-line="247">            <span class="n">max_sentence_length</span><span class="o">=</span><span class="mi">4192</span>
</span><span data-line="248">        <span class="p">)</span>
</span><span data-line="249">        
</span><span data-line="250">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Training complete!&quot;</span><span class="p">)</span>
</span><span data-line="251">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model saved to: </span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">.model&quot;</span><span class="p">)</span>
</span><span data-line="252">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vocab saved to: </span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">.vocab&quot;</span><span class="p">)</span>
</span><span data-line="253">        
</span><span data-line="254">    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;bpe&#39;</span><span class="p">:</span>
</span><span data-line="255">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="256">            <span class="kn">from</span><span class="w"> </span><span class="nn">tokenizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">pre_tokenizers</span><span class="p">,</span> <span class="n">trainers</span><span class="p">,</span> <span class="n">normalizers</span>
</span><span data-line="257">            <span class="kn">from</span><span class="w"> </span><span class="nn">tokenizers.processors</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemplateProcessing</span>
</span><span data-line="258">        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span data-line="259">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: HuggingFace tokenizers not installed.&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="260">            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Install with: pip install tokenizers&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span><span data-line="261">            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="262">        
</span><span data-line="263">        <span class="c1"># preprocess if needed</span>
</span><span data-line="264">        <span class="n">train_file</span> <span class="o">=</span> <span class="n">input_file</span>
</span><span data-line="265">        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">no_preprocess</span><span class="p">:</span>
</span><span data-line="266">            <span class="n">preprocessed</span> <span class="o">=</span> <span class="n">output_prefix</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.preprocessed.txt&#39;</span><span class="p">)</span>
</span><span data-line="267">            <span class="n">preprocess_corpus</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">preprocessed</span><span class="p">)</span>
</span><span data-line="268">            <span class="n">train_file</span> <span class="o">=</span> <span class="n">preprocessed</span>
</span><span data-line="269">        
</span><span data-line="270">        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Training BPE Tokenizer ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="271">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="n">train_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="272">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output: </span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="273">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vocab size: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">vocab_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="274">        <span class="nb">print</span><span class="p">()</span>
</span><span data-line="275">        
</span><span data-line="276">        <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">BPE</span><span class="p">())</span>
</span><span data-line="277">        <span class="n">tokenizer</span><span class="o">.</span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">normalizers</span><span class="o">.</span><span class="n">NFKC</span><span class="p">()</span>
</span><span data-line="278">        <span class="n">tokenizer</span><span class="o">.</span><span class="n">pre_tokenizer</span> <span class="o">=</span> <span class="n">pre_tokenizers</span><span class="o">.</span><span class="n">Whitespace</span><span class="p">()</span>
</span><span data-line="279">        
</span><span data-line="280">        <span class="n">trainer</span> <span class="o">=</span> <span class="n">trainers</span><span class="o">.</span><span class="n">BpeTrainer</span><span class="p">(</span>
</span><span data-line="281">            <span class="n">vocab_size</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span>
</span><span data-line="282">            <span class="n">min_frequency</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">min_freq</span><span class="p">,</span>
</span><span data-line="283">            <span class="n">special_tokens</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&lt;pad&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;unk&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;s&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;/s&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;mask&gt;&#39;</span><span class="p">],</span>
</span><span data-line="284">            <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span>
</span><span data-line="285">        <span class="p">)</span>
</span><span data-line="286">        
</span><span data-line="287">        <span class="n">tokenizer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">train_file</span><span class="p">)],</span> <span class="n">trainer</span><span class="o">=</span><span class="n">trainer</span><span class="p">)</span>
</span><span data-line="288">        
</span><span data-line="289">        <span class="n">tokenizer</span><span class="o">.</span><span class="n">post_processor</span> <span class="o">=</span> <span class="n">TemplateProcessing</span><span class="p">(</span>
</span><span data-line="290">            <span class="n">single</span><span class="o">=</span><span class="s2">&quot;&lt;s&gt; $A &lt;/s&gt;&quot;</span><span class="p">,</span>
</span><span data-line="291">            <span class="n">pair</span><span class="o">=</span><span class="s2">&quot;&lt;s&gt; $A &lt;/s&gt; &lt;s&gt; $B &lt;/s&gt;&quot;</span><span class="p">,</span>
</span><span data-line="292">            <span class="n">special_tokens</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="293">                <span class="p">(</span><span class="s2">&quot;&lt;s&gt;&quot;</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">token_to_id</span><span class="p">(</span><span class="s2">&quot;&lt;s&gt;&quot;</span><span class="p">)),</span>
</span><span data-line="294">                <span class="p">(</span><span class="s2">&quot;&lt;/s&gt;&quot;</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">token_to_id</span><span class="p">(</span><span class="s2">&quot;&lt;/s&gt;&quot;</span><span class="p">)),</span>
</span><span data-line="295">            <span class="p">],</span>
</span><span data-line="296">        <span class="p">)</span>
</span><span data-line="297">        
</span><span data-line="298">        <span class="n">output_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_prefix</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.json&#39;</span>
</span><span data-line="299">        <span class="n">tokenizer</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</span><span data-line="300">        
</span><span data-line="301">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Training complete!&quot;</span><span class="p">)</span>
</span><span data-line="302">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tokenizer saved to: </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

</span><span data-line="303">
</span><span data-line="304">
<div class="viewcode-block" id="main">
<a class="viewcode-back" href="../../cli.html#akshar.cli.main">[docs]</a>
</span><span data-line="305"><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span data-line="306"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Main CLI entry point. Dispatches to subcommands.&quot;&quot;&quot;</span>
</span><span data-line="307">    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
</span><span data-line="308">        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;akshar: Linguistically-aware tokenizer for Hindi, Sanskrit, and Hinglish&quot;</span>
</span><span data-line="309">    <span class="p">)</span>
</span><span data-line="310">    
</span><span data-line="311">    <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Available commands&#39;</span><span class="p">)</span>
</span><span data-line="312">    
</span><span data-line="313">    <span class="c1"># tokenize command</span>
</span><span data-line="314">    <span class="n">tokenize_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s1">&#39;tokenize&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Tokenize text&#39;</span><span class="p">)</span>
</span><span data-line="315">    <span class="n">tokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Text to tokenize&#39;</span><span class="p">)</span>
</span><span data-line="316">    <span class="n">tokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--input&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Input file&#39;</span><span class="p">)</span>
</span><span data-line="317">    <span class="n">tokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output file&#39;</span><span class="p">)</span>
</span><span data-line="318">    <span class="n">tokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="s1">&#39;--model&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to trained model&#39;</span><span class="p">)</span>
</span><span data-line="319">    <span class="n">tokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--model-type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span>
</span><span data-line="320">                                <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span> <span class="s1">&#39;bpe&#39;</span><span class="p">])</span>
</span><span data-line="321">    <span class="n">tokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--format&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">],</span>
</span><span data-line="322">                                <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output format: text (tokens), json, or id (token IDs, requires --model)&#39;</span><span class="p">)</span>
</span><span data-line="323">    
</span><span data-line="324">    <span class="c1"># detokenize command</span>
</span><span data-line="325">    <span class="n">detokenize_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s1">&#39;detokenize&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Detokenize tokens&#39;</span><span class="p">)</span>
</span><span data-line="326">    <span class="n">detokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;tokens&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Space-separated tokens&#39;</span><span class="p">)</span>
</span><span data-line="327">    <span class="n">detokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--input&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Input file (tokens)&#39;</span><span class="p">)</span>
</span><span data-line="328">    <span class="n">detokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output file&#39;</span><span class="p">)</span>
</span><span data-line="329">    <span class="n">detokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="s1">&#39;--model&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to trained model&#39;</span><span class="p">)</span>
</span><span data-line="330">    <span class="n">detokenize_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--model-type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span>
</span><span data-line="331">                                  <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span> <span class="s1">&#39;bpe&#39;</span><span class="p">])</span>
</span><span data-line="332">    
</span><span data-line="333">    <span class="c1"># explain command</span>
</span><span data-line="334">    <span class="n">explain_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s1">&#39;explain&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Analyze text in detail&#39;</span><span class="p">)</span>
</span><span data-line="335">    <span class="n">explain_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Text to analyze&#39;</span><span class="p">)</span>
</span><span data-line="336">    <span class="n">explain_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="s1">&#39;--model&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to trained model&#39;</span><span class="p">)</span>
</span><span data-line="337">    <span class="n">explain_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--model-type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span>
</span><span data-line="338">                               <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span> <span class="s1">&#39;bpe&#39;</span><span class="p">])</span>
</span><span data-line="339">    
</span><span data-line="340">    <span class="c1"># train command</span>
</span><span data-line="341">    <span class="n">train_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Train a tokenizer model&#39;</span><span class="p">)</span>
</span><span data-line="342">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Input corpus file&#39;</span><span class="p">)</span>
</span><span data-line="343">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output model prefix (e.g., models/akshar)&#39;</span><span class="p">)</span>
</span><span data-line="344">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--vocab-size&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">24000</span><span class="p">,</span>
</span><span data-line="345">                             <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Vocabulary size (default: 24000)&#39;</span><span class="p">)</span>
</span><span data-line="346">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--model-type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span>
</span><span data-line="347">                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sentencepiece&#39;</span><span class="p">,</span> <span class="s1">&#39;bpe&#39;</span><span class="p">],</span>
</span><span data-line="348">                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Model type (default: sentencepiece)&#39;</span><span class="p">)</span>
</span><span data-line="349">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--coverage&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.9997</span><span class="p">,</span>
</span><span data-line="350">                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Character coverage for SentencePiece (default: 0.9997)&#39;</span><span class="p">)</span>
</span><span data-line="351">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--spm-model-type&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;unigram&#39;</span><span class="p">,</span>
</span><span data-line="352">                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unigram&#39;</span><span class="p">,</span> <span class="s1">&#39;bpe&#39;</span><span class="p">],</span>
</span><span data-line="353">                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;SentencePiece model type (default: unigram)&#39;</span><span class="p">)</span>
</span><span data-line="354">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--min-freq&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span data-line="355">                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Minimum frequency for BPE (default: 2)&#39;</span><span class="p">)</span>
</span><span data-line="356">    <span class="n">train_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--no-preprocess&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
</span><span data-line="357">                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Skip preprocessing step&#39;</span><span class="p">)</span>
</span><span data-line="358">    
</span><span data-line="359">    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span><span data-line="360">    
</span><span data-line="361">    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
</span><span data-line="362">        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
</span><span data-line="363">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="364">    
</span><span data-line="365">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s1">&#39;tokenize&#39;</span><span class="p">:</span>
</span><span data-line="366">        <span class="n">tokenize_command</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span data-line="367">    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s1">&#39;detokenize&#39;</span><span class="p">:</span>
</span><span data-line="368">        <span class="n">detokenize_command</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span data-line="369">    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s1">&#39;explain&#39;</span><span class="p">:</span>
</span><span data-line="370">        <span class="n">explain_command</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span data-line="371">    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s1">&#39;train&#39;</span><span class="p">:</span>
</span><span data-line="372">        <span class="n">train_command</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

</span><span data-line="373">
</span><span data-line="374">
</span><span data-line="375"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span><span data-line="376">    <span class="n">main</span><span class="p">()</span>
</span><span data-line="377">
</span></pre></div>
        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2025, Akshar contributors</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials"></div>
    </div>
  </div>
</footer>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/shibuya.js?v=c1cf1a6b"></script></body>
</html>